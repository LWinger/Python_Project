import pandas as pd
import numpy as np
hotels_df = pd.read_csv('Hotel Data.csv')
hotels_df.columns = ['ID','Hotel', 'Hotel Link','Number Reviews','Review Link','Rating','Rank']

#clean Hotels Data Frame
hotels_df['Number Reviews'] = hotels_df['Number Reviews'].astype(str).str.split().str.get(0).str.replace(",","")
hotels_df['Number Reviews'] = hotels_df['Number Reviews'].astype(int)

hotels_df['Rating'] = hotels_df['Rating'].astype(str).str.split().str.get(0)
hotels_df['Rating'] = hotels_df['Rating'].astype(float)

hotels_df['Rank'] = hotels_df['Rank'].astype(str).str.split().str.get(0).str.replace("#","")
hotels_df['Rank'] = hotels_df['Rank'].astype(float)

print(hotels_df.dtypes)

#clean & merge Reviews Data Frame
#if error reading file then maybe extra columns in line identified in last line of error message
reviews_df = pd.read_csv('Review Data.csv')
reviews_df.head(10)

#reviews_df = reviews_df.ix[:,0:11] #sometimes python reads in additional empty columns so this prevents that
reviews_df.columns = ['Index','Address','Help Count','Hotel Count','Location','Hotel Name','Rating','Rating Date','Review','Review Count','Review Title','Reviewer','Extra1','Extra2']
reviews_df.head(10)

#if error converting to float then there is probably an error in the row identified... text can't be converted
#reviews_df['Review Count'] = reviews_df['Review Count'].astype(int)
#reviews_df['Help Count'] = reviews_df['Help Count'].astype(int)
#reviews_df['Hotel Count'] = reviews_df['Hotel Count'].astype(int)

#Drop unwanted rows (for 'NaN' in Help Count)
reviews_df = reviews_df.drop(reviews_df[pd.isnull(reviews_df['Help Count'])].index)

#print(reviews_df.dtypes)

#count number of reviews scrapped
#print(len(reviews_df['Hotel']),'Reviews Scraped')

#count number of reviews in tripadvisor
#print(sum(hotels_df[60:70]['Number Reviews']),'Reviews in Tripadvisor')

#error
#error = sum(hotels_df[60:70]['Number Reviews'])-len(reviews_df['Hotel'])
#print(error, 'Reviews Missing')
