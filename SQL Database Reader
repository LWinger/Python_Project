#connect to mySQL
import pymysql #Connector library for mysql

#Set up a connection with the server
conn = pymysql.connect(host='localhost', port=3307, user='root')
#And a cursor object that will serve as a virtual 'cursor'
curr = conn.cursor()

curr.execute('show databases;')

#check connection
for row in curr:
    print(row)

import pandas as pd
hotels = pd.read_sql('select * from NYC_sleep_eat.hotels;', conn)
reviews = pd.read_sql('select * from NYC_sleep_eat.reviews;', conn)

#clean review date
a = reviews['review_date'].astype(str).str.split().str.get(0).str[2:]
reviews['review_date'] = str('20') + a

reviews['review_date'] = pd.to_datetime(reviews['review_date'])

print(reviews.dtypes)
print(hotels.dtypes)

